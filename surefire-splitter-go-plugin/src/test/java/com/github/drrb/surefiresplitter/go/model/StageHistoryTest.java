/**
 * Surefire Splitter Go Plugin
 * Copyright (C) 2016 drrb
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Surefire Splitter Go Plugin. If not, see <http://www.gnu.org/licenses />.
 */
package com.github.drrb.surefiresplitter.go.model;

import org.junit.Test;

import static org.hamcrest.core.Is.is;
import static org.junit.Assert.*;

public class StageHistoryTest {

    @Test
    public void shouldDeserializeWithExtraFields() {
        StageHistory stageHistory = StageHistory.fromJson("{\"stages\":[{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-1\",\"id\":57,\"scheduled_date\":1446013615346},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":58,\"scheduled_date\":1446013615346},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":59,\"scheduled_date\":1446013615346}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"admin\",\"pipeline_counter\":23,\"id\":23,\"counter\":\"1\"},{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-1\",\"id\":54,\"scheduled_date\":1445995853491},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":55,\"scheduled_date\":1445995853491},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":56,\"scheduled_date\":1445995853491}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"admin\",\"pipeline_counter\":22,\"id\":22,\"counter\":\"1\"},{\"result\":\"Passed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Passed\",\"name\":\"test-runInstance-1\",\"id\":51,\"scheduled_date\":1445995041877},{\"state\":\"Completed\",\"result\":\"Passed\",\"name\":\"test-runInstance-2\",\"id\":52,\"scheduled_date\":1445995041877},{\"state\":\"Completed\",\"result\":\"Passed\",\"name\":\"test-runInstance-3\",\"id\":53,\"scheduled_date\":1445995041877}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"anonymous\",\"pipeline_counter\":21,\"id\":21,\"counter\":\"1\"},{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-1\",\"id\":48,\"scheduled_date\":1445994686835},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":49,\"scheduled_date\":1445994686835},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":50,\"scheduled_date\":1445994686835}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"anonymous\",\"pipeline_counter\":20,\"id\":20,\"counter\":\"1\"},{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Passed\",\"name\":\"test-runInstance-1\",\"id\":45,\"scheduled_date\":1445994555371},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":46,\"scheduled_date\":1445994555371},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":47,\"scheduled_date\":1445994555371}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"anonymous\",\"pipeline_counter\":19,\"id\":19,\"counter\":\"1\"},{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-1\",\"id\":42,\"scheduled_date\":1445932130287},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":43,\"scheduled_date\":1445932130287},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":44,\"scheduled_date\":1445932130287}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"anonymous\",\"pipeline_counter\":18,\"id\":18,\"counter\":\"1\"},{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-1\",\"id\":39,\"scheduled_date\":1445932037995},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":40,\"scheduled_date\":1445932037995},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":41,\"scheduled_date\":1445932037995}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"anonymous\",\"pipeline_counter\":17,\"id\":17,\"counter\":\"1\"},{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-1\",\"id\":36,\"scheduled_date\":1445931889546},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":37,\"scheduled_date\":1445931889546},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":38,\"scheduled_date\":1445931889546}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"anonymous\",\"pipeline_counter\":16,\"id\":16,\"counter\":\"1\"},{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-1\",\"id\":33,\"scheduled_date\":1445931354958},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":34,\"scheduled_date\":1445931354958},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":35,\"scheduled_date\":1445931354958}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"anonymous\",\"pipeline_counter\":15,\"id\":15,\"counter\":\"1\"},{\"result\":\"Failed\",\"pipeline_name\":\"basic\",\"jobs\":[{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-1\",\"id\":30,\"scheduled_date\":1445931108179},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-2\",\"id\":31,\"scheduled_date\":1445931108180},{\"state\":\"Completed\",\"result\":\"Failed\",\"name\":\"test-runInstance-3\",\"id\":32,\"scheduled_date\":1445931108180}],\"name\":\"commit\",\"rerun_of_counter\":null,\"approval_type\":\"success\",\"approved_by\":\"anonymous\",\"pipeline_counter\":14,\"id\":14,\"counter\":\"1\"}],\"pagination\":{\"offset\":0,\"total\":23,\"page_size\":10}}");
        assertThat(stageHistory.getStages().size(), is(10));
    }
}
